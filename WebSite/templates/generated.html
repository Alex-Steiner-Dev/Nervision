<!DOCTYPE html>
<html>
<head>
	<title>Nervision</title>
	<link type="text/css" href="static/css/generation.css" rel="stylesheet"/>
	<link type="text/css" href="static/css/main.css" rel="stylesheet"/>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.1.1/model-viewer.min.js"></script>
</head>
<body>
    <div id="loader" class="loader"></div>

    <model-viewer id='canvas' src="shared-assets/models/NeilArmstrong.glb"shadow-intensity="1" camera-controls touch-action="pan-y"></model-viewer>
    
    <script>
        document.getElementById('canvas').style.visibility = "hidden";
        document.getElementById('download').style.visibility = "hidden";

        function doesFileExist(urlToFile)
        {
            var xhr = new XMLHttpRequest();
            xhr.open('HEAD', urlToFile, false);
            xhr.send();

            if (xhr.status == "404") {
                return false;
            } else {
                return true;
            }
        }

        async function check(){
            if(doesFileExist("generations/" + "<%= random %>" + "/model.gltf"))
            {
                document.getElementById('canvas').style.visibility = "visible";
                document.getElementById('download').style.visibility = "visible";
                document.getElementById("loader").remove();
                clearInterval(interval)
            }
        }

        var interval = setInterval(check, 1000);

    </script> 

</body>
</html>